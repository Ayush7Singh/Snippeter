<!DOCTYPE html>
<html>
<head>
  <title>Process Snippet</title>
  <script>
    window.addEventListener('DOMContentLoaded', () => {
      const urlParams = new URLSearchParams(window.location.search);
      const encodedSnippet = urlParams.get('data');

      if (encodedSnippet) {
        try {
          // Decode the snippet data
          const decodedSnippet = JSON.parse(atob(decodeURIComponent(encodedSnippet)));

          // Use fetch to send data to the background script
          fetch('https://emmmeocljbdocodkjahjpakcgafloidb.chromiumapp.org/process-snippet', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify(decodedSnippet)
          }).then(response => response.json())
            .then(data => {
              if (data.success) {
                alert('Snippet successfully added to your extension!');
              } else {
                alert('Failed to add snippet.');
              }
            }).catch(error => {
              console.error('Failed to send snippet data:', error);
              alert('Failed to send snippet data.');
            });
        } catch (e) {
          console.error('Failed to decode snippet data:', e);
          alert('Invalid snippet data.');
        }
      } else {
        alert('No snippet data found.');
      }
    });
  </script>
</head>
<body>
  <h1>Processing Snippet...</h1>
</body>
</html>
